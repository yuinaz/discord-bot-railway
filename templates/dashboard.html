{% extends 'base.html' %}
{% block title %}Dashboard - SatpamBot{% endblock %}
{% block content %}
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<div id="neo-root">
  <!-- Konten dashboard neon akan diisi JS (lihat versi sebelumnya) -->
  <div class="card" id="err" style="display:none; padding:12px; color:#ff9fb2;"></div>
</div>
<script>
(async()=>{
  try{
    const r = await fetch('/api/dashboard_plus', {headers:{'Accept':'application/json'}});
    const ct = r.headers.get('content-type')||'';
    if(!ct.includes('application/json')){
      const txt = await r.text();
      document.getElementById('err').style.display='block';
      document.getElementById('err').textContent = 'Gagal memuat data (bukan JSON), kemungkinan sesi login expired.';
      console.warn('Non-JSON response:', txt);
      return;
    }
    const d = await r.json();
    if(!d || !d.base){ throw new Error('payload invalid'); }
    // TODO: render neon layout here or keep the previously provided dashboard.html
    // (Karena banyak, gunakan file dashboard neon yang sudah saya kirim sebelumnya.)
  }catch(e){
    document.getElementById('err').style.display='block';
    document.getElementById('err').textContent = 'Gagal memuat dashboard: '+e.message;
    console.error(e);
  }
})();
</script>
{% endblock %}
{% extends "base.html" %}
{% block content %}
<div class="grid">
  <div class="card">
    <div class="card-title">Status Servers</div>
    <div class="card-body">
      <table id="servers-table">
        <thead><tr><th>Nama</th><th>Status</th><th>Ping</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div class="card">
    <div class="card-title">Activity</div>
    <div class="card-body">
      <div id="activity-log">Menunggu data...</div>
    </div>
  </div>
</div>

<script>
async function loadServers(){
  try{
    const res = await fetch('/api/servers');
    if(!res.ok){ throw new Error('unauthorized'); }
    const data = await res.json();
    const tbody = document.querySelector('#servers-table tbody');
    tbody.innerHTML = '';
    data.forEach(s => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${s.name}</td><td>${s.status}</td><td>${s.ping_ms} ms</td>`;
      tbody.appendChild(tr);
    });
  } catch(e){
    document.querySelector('#activity-log').textContent = 'Gagal memuat data.';
  }
}
loadServers();
</script>
{% endblock %}

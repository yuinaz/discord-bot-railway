{% extends "base.html" %}
{% set active="settings" %}
{% block body %}
<h2 style="margin:0 0 14px 0">Settings</h2>

<div class="card">
  <div class="body">
    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));">
      <div>
        <label class="label">Theme</label>
        <select class="select" data-ui="theme" id="ui-theme">
          <option>Dark</option>
          <option>Light</option>
          <option>Ocean</option>
          <option>Nord</option>
        </select>
      </div>
      <div>
        <label class="label">Accent Color</label>
        <input class="input" data-ui="accent" id="ui-accent" placeholder="#2563eb">
      </div>
      <div>
        <label class="label">Background Mode</label>
        <select class="select" data-ui="bgmode" id="ui-bgmode">
          <option>None</option>
          <option>Image</option>
          <option>Particles</option>
        </select>
      </div>
      <div>
        <label class="label">Background URL</label>
        <input class="input" data-ui="bgurl" id="ui-bgurl" placeholder="/uploads/bg.jpg">
      </div>
      <div>
        <label class="label">Apply to Login</label>
        <input type="checkbox" data-ui="applylogin" id="ui-apply-login">
      </div>
    </div>
    <div style="margin-top:14px; display:flex; gap:10px">
      <button class="btn" id="ui-save">Save</button>
      <button class="btn ghost" id="ui-preview">Preview</button>
    </div>
  </div>
</div>

<script>
(async function(){
  async function save(payload){
    // Simpan ke backend jika tersedia
    try{
      const r = await fetch('/api/ui-config', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      if(r.ok) return;
    }catch(e){}
    // Fallback localStorage
    localStorage.setItem('neo.ui', JSON.stringify(payload));
  }
  function collect(){
    return {
      theme: document.getElementById('ui-theme').value,
      accent: document.getElementById('ui-accent').value,
      bg_mode: document.getElementById('ui-bgmode').value,
      bg_url: document.getElementById('ui-bgurl').value,
      apply_login: document.getElementById('ui-apply-login').checked
    };
  }
  function apply(cfg){
    document.documentElement.setAttribute('data-theme', (cfg.theme||'dark').toLowerCase());
    if(cfg.accent) document.documentElement.style.setProperty('--acc', cfg.accent);
  }
  document.getElementById('ui-save').addEventListener('click', async ()=>{
    const cfg = collect(); await save(cfg); apply(cfg);
  });
  document.getElementById('ui-preview').addEventListener('click', ()=>{ apply(collect()); });
})();
</script>
{% endblock %}

{% extends "base.html" %}
{% block title %}Settings{% endblock %}
{% block content %}
<section class="card">
  <h3>Appearance</h3>
  <label>Accent Color <input id="accent" placeholder="#2563eb"></label>
  <label>Background Mode
    <select id="bgmode">
      <option value="">None</option>
      <option value="image">Image</option>
      <option value="video">Video</option>
    </select>
  </label>
  <label>Background URL <input id="bgurl" placeholder="/uploads/your-bg.jpg"></label>
  <div>
    <input type="file" id="bgfile">
    <button id="uploadBg">Upload</button>
  </div>
  <button id="saveUi">Save</button>
  <span id="saveStatus" class="muted"></span>
</section>
<script>
(async () => {
  const cfg = await (await fetch('/api/ui-config')).json();
  if(cfg.accent_color) document.getElementById('accent').value = cfg.accent_color;
  if(cfg.background_mode) document.getElementById('bgmode').value = cfg.background_mode;
  if(cfg.background_url) document.getElementById('bgurl').value = cfg.background_url;
})();

document.getElementById('uploadBg').onclick = async () => {
  const f = document.getElementById('bgfile').files[0];
  if(!f){ alert('Pilih file dulu'); return; }
  const fd = new FormData(); fd.append('file', f);
  const res = await fetch('/api/upload/background', {method:'POST', body: fd});
  const js = await res.json();
  document.getElementById('bgurl').value = js.url || '';
};

document.getElementById('saveUi').onclick = async () => {
  const body = {accent_color: document.getElementById('accent').value,
                background_mode: document.getElementById('bgmode').value,
                background_url: document.getElementById('bgurl').value};
  const res = await fetch('/api/ui-config', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  document.getElementById('saveStatus').textContent = (await res.json()).ok ? 'Saved' : 'Failed';
};
</script>
{% endblock %}

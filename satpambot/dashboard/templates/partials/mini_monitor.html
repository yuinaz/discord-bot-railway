<script>
(function(){
  const $uptime = document.getElementById('mm-uptime');
  const $cpu    = document.getElementById('mm-cpu');
  const $ram    = document.getElementById('mm-ram');

  async function tick(){
    try {
      const r = await fetch('/api/live', {cache:'no-store'});
      if (!r.ok) throw new Error('live not ok');
      const j = await r.json();

      if ($uptime) $uptime.textContent = 'Uptime: ' + (j.uptime_human || '--');
      if ($cpu)    $cpu.textContent    = 'CPU: ' + (j.cpu_percent ?? '--') + '%';
      if ($ram)    $ram.textContent    = 'RAM: ' + (j.ram_mb ?? '--') + ' MB';
    } catch(_) {
      // fallback ringan agar tidak spam
      try { await fetch('/api/ping', {cache:'no-store'}); } catch(e){}
    } finally {
      setTimeout(tick, 12000); // 12s, biar adem
    }
  }
  tick();
})();
</script>
